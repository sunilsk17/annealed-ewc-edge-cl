==========================================
COMPLETING ResNet-18 CIFAR-100
Remaining: λ=2000, λ=5000, Annealed
Start time: Fri Jan 30 22:12:34 IST 2026
Estimated: 2-2.5 hours
==========================================

Cleaning up incomplete λ=2000...

[1/3] Training λ=2000...
/Users/sunilkumars/Desktop/EWC Project/drift_cl_edge/venv/lib/python3.13/site-packages/torchvision/datasets/cifar.py:83: VisibleDeprecationWarning: dtype(): align should be passed as Python or NumPy boolean but got `align=0`. Did you mean to pass a tuple to create a subarray type? (Deprecated NumPy 2.4)
  entry = pickle.load(f, encoding="latin1")
/Users/sunilkumars/Desktop/EWC Project/drift_cl_edge/venv/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
Using device: mps
Training ResNet-18 on Split-CIFAR-100: 10 tasks, 10 epochs/task, λ=2000.0
Split-CIFAR-100 initialized:
  Tasks: 10
  Classes per task: 10
  Class order: [83 53 70 45 44 39 22 80 10  0 18 30 73 33 90  4 76 77 12 31]... (first 20)
Task 0: Classes [83, 53, 70, 45, 44, 39, 22, 80, 10, 0]
  Train samples: 5000
  Test samples: 1000
Task 1: Classes [18, 30, 73, 33, 90, 4, 76, 77, 12, 31]
  Train samples: 5000
  Test samples: 1000
Task 2: Classes [55, 88, 26, 42, 69, 15, 40, 96, 9, 72]
  Train samples: 5000
  Test samples: 1000
Task 3: Classes [11, 47, 85, 28, 93, 5, 66, 65, 35, 16]
  Train samples: 5000
  Test samples: 1000
Task 4: Classes [49, 34, 7, 95, 27, 19, 81, 25, 62, 13]
  Train samples: 5000
  Test samples: 1000
Task 5: Classes [24, 3, 17, 38, 8, 78, 6, 64, 36, 89]
  Train samples: 5000
  Test samples: 1000
Task 6: Classes [56, 99, 54, 43, 50, 67, 46, 68, 61, 97]
  Train samples: 5000
  Test samples: 1000
Task 7: Classes [79, 41, 58, 48, 98, 57, 75, 32, 94, 59]
  Train samples: 5000
  Test samples: 1000
Task 8: Classes [63, 84, 37, 29, 1, 52, 21, 2, 23, 87]
  Train samples: 5000
  Test samples: 1000
Task 9: Classes [91, 74, 86, 82, 20, 60, 71, 14, 92, 51]
  Train samples: 5000
  Test samples: 1000

============================================================
Training on Task 0 (Classes: [83, 53, 70, 45, 44, 39, 22, 80, 10, 0])
============================================================
Epoch 1/10 - Loss: 1.9081 - Acc: 0.3458
Epoch 2/10 - Loss: 1.5242 - Acc: 0.4508
Epoch 3/10 - Loss: 1.3074 - Acc: 0.5294
Epoch 4/10 - Loss: 1.2123 - Acc: 0.5754
Epoch 5/10 - Loss: 1.0949 - Acc: 0.6240
Epoch 6/10 - Loss: 0.9770 - Acc: 0.6582
Epoch 7/10 - Loss: 0.8520 - Acc: 0.6928
Epoch 8/10 - Loss: 0.6823 - Acc: 0.7652
Epoch 9/10 - Loss: 0.5657 - Acc: 0.7986
Epoch 10/10 - Loss: 0.4748 - Acc: 0.8432
Saved: results_resnet_cifar100/lambda_sweep/lambda_2000/model_task0.pt
Computing Fisher for Task 0...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 1 (Classes: [18, 30, 73, 33, 90, 4, 76, 77, 12, 31])
============================================================
Epoch 1/10 - Loss: 3.7261 - Acc: 0.3298
Epoch 2/10 - Loss: 1.5954 - Acc: 0.5428
Epoch 3/10 - Loss: 1.2845 - Acc: 0.6570
Epoch 4/10 - Loss: 1.1835 - Acc: 0.7222
Epoch 5/10 - Loss: 1.1316 - Acc: 0.7516
Epoch 6/10 - Loss: 1.2076 - Acc: 0.7812
Epoch 7/10 - Loss: 1.0446 - Acc: 0.8252
Epoch 8/10 - Loss: 1.2645 - Acc: 0.8166
Epoch 9/10 - Loss: 1.1171 - Acc: 0.8400
Epoch 10/10 - Loss: 0.9134 - Acc: 0.8932
Saved: results_resnet_cifar100/lambda_sweep/lambda_2000/model_task1.pt
Computing Fisher for Task 1...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 2 (Classes: [55, 88, 26, 42, 69, 15, 40, 96, 9, 72])
============================================================
Epoch 1/10 - Loss: 6.8026 - Acc: 0.2562
Epoch 2/10 - Loss: 2.2706 - Acc: 0.5184
Epoch 3/10 - Loss: 1.8445 - Acc: 0.6180
Epoch 4/10 - Loss: 1.7213 - Acc: 0.6834
Epoch 5/10 - Loss: 1.7657 - Acc: 0.7060
Epoch 6/10 - Loss: 1.7964 - Acc: 0.7330
Epoch 7/10 - Loss: 1.8958 - Acc: 0.7454
Epoch 8/10 - Loss: 2.1919 - Acc: 0.7336
Epoch 9/10 - Loss: 1.7630 - Acc: 0.8190
Epoch 10/10 - Loss: 1.4676 - Acc: 0.8678
Saved: results_resnet_cifar100/lambda_sweep/lambda_2000/model_task2.pt
Computing Fisher for Task 2...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 3 (Classes: [11, 47, 85, 28, 93, 5, 66, 65, 35, 16])
============================================================
Epoch 1/10 - Loss: 10.7638 - Acc: 0.1760
Epoch 2/10 - Loss: 2.8400 - Acc: 0.5652
Epoch 3/10 - Loss: 2.6268 - Acc: 0.6550
Epoch 4/10 - Loss: 2.6388 - Acc: 0.6806
Epoch 5/10 - Loss: 2.7202 - Acc: 0.7006
Epoch 6/10 - Loss: 2.5217 - Acc: 0.7490
Epoch 7/10 - Loss: 2.8460 - Acc: 0.7434
Epoch 8/10 - Loss: 2.7012 - Acc: 0.7796
Epoch 9/10 - Loss: 2.3968 - Acc: 0.8134
Epoch 10/10 - Loss: 2.4163 - Acc: 0.8322
Saved: results_resnet_cifar100/lambda_sweep/lambda_2000/model_task3.pt
Computing Fisher for Task 3...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 4 (Classes: [49, 34, 7, 95, 27, 19, 81, 25, 62, 13])
============================================================
Epoch 1/10 - Loss: 15.3284 - Acc: 0.0886
Epoch 2/10 - Loss: 3.4412 - Acc: 0.5454
Epoch 3/10 - Loss: 2.8972 - Acc: 0.6918
Epoch 4/10 - Loss: 3.0883 - Acc: 0.7046
Epoch 5/10 - Loss: 2.9037 - Acc: 0.7204
Epoch 6/10 - Loss: 3.0922 - Acc: 0.7336
Epoch 7/10 - Loss: 3.0966 - Acc: 0.7384
Epoch 8/10 - Loss: 2.7699 - Acc: 0.7786
Epoch 9/10 - Loss: 2.9386 - Acc: 0.7680
Epoch 10/10 - Loss: 3.3652 - Acc: 0.7716
Saved: results_resnet_cifar100/lambda_sweep/lambda_2000/model_task4.pt
Computing Fisher for Task 4...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 5 (Classes: [24, 3, 17, 38, 8, 78, 6, 64, 36, 89])
============================================================
Epoch 1/10 - Loss: 18.7542 - Acc: 0.0432
Epoch 2/10 - Loss: 4.2590 - Acc: 0.4350
Epoch 3/10 - Loss: 3.1829 - Acc: 0.6500
Epoch 4/10 - Loss: 3.4279 - Acc: 0.6646
Epoch 5/10 - Loss: 3.3638 - Acc: 0.6758
Epoch 6/10 - Loss: 3.3066 - Acc: 0.6984
Epoch 7/10 - Loss: 3.2413 - Acc: 0.7168
Epoch 8/10 - Loss: 3.2175 - Acc: 0.7324
Epoch 9/10 - Loss: 3.2165 - Acc: 0.7432
Epoch 10/10 - Loss: 3.4994 - Acc: 0.7312
Saved: results_resnet_cifar100/lambda_sweep/lambda_2000/model_task5.pt
Computing Fisher for Task 5...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 6 (Classes: [56, 99, 54, 43, 50, 67, 46, 68, 61, 97])
============================================================
Epoch 1/10 - Loss: 21.4290 - Acc: 0.0170
Epoch 2/10 - Loss: 6.3965 - Acc: 0.2050
Epoch 3/10 - Loss: 3.9763 - Acc: 0.5744
Epoch 4/10 - Loss: 3.3035 - Acc: 0.6938
Epoch 5/10 - Loss: 3.3477 - Acc: 0.7262
Epoch 6/10 - Loss: 3.4002 - Acc: 0.7304
Epoch 7/10 - Loss: 3.1670 - Acc: 0.7502
Epoch 8/10 - Loss: 3.2534 - Acc: 0.7724
Epoch 9/10 - Loss: 3.5860 - Acc: 0.7502
Epoch 10/10 - Loss: 3.1455 - Acc: 0.7794
Saved: results_resnet_cifar100/lambda_sweep/lambda_2000/model_task6.pt
Computing Fisher for Task 6...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 7 (Classes: [79, 41, 58, 48, 98, 57, 75, 32, 94, 59])
============================================================
Epoch 1/10 - Loss: 26.6469 - Acc: 0.0000
Epoch 2/10 - Loss: 7.3597 - Acc: 0.2084
Epoch 3/10 - Loss: 3.7493 - Acc: 0.6812
Epoch 4/10 - Loss: 3.3243 - Acc: 0.7566
Epoch 5/10 - Loss: 3.3891 - Acc: 0.7618
Epoch 6/10 - Loss: 3.3467 - Acc: 0.7716
Epoch 7/10 - Loss: 3.3987 - Acc: 0.7730
Epoch 8/10 - Loss: 3.3958 - Acc: 0.7742
Epoch 9/10 - Loss: 3.2131 - Acc: 0.7852
Epoch 10/10 - Loss: 3.3099 - Acc: 0.7868
Saved: results_resnet_cifar100/lambda_sweep/lambda_2000/model_task7.pt
Computing Fisher for Task 7...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 8 (Classes: [63, 84, 37, 29, 1, 52, 21, 2, 23, 87])
============================================================
Epoch 1/10 - Loss: 29.3203 - Acc: 0.0004
Epoch 2/10 - Loss: 9.6425 - Acc: 0.1086
Epoch 3/10 - Loss: 4.8404 - Acc: 0.5278
Epoch 4/10 - Loss: 3.6735 - Acc: 0.7218
Epoch 5/10 - Loss: 3.5879 - Acc: 0.7326
Epoch 6/10 - Loss: 3.4329 - Acc: 0.7574
Epoch 7/10 - Loss: 3.2433 - Acc: 0.7786
Epoch 8/10 - Loss: 3.2353 - Acc: 0.7808
Epoch 9/10 - Loss: 3.4253 - Acc: 0.7736
Epoch 10/10 - Loss: 3.2975 - Acc: 0.7740
Saved: results_resnet_cifar100/lambda_sweep/lambda_2000/model_task8.pt
Computing Fisher for Task 8...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 9 (Classes: [91, 74, 86, 82, 20, 60, 71, 14, 92, 51])
============================================================
Epoch 1/10 - Loss: 32.8399 - Acc: 0.0008
Epoch 2/10 - Loss: 13.0246 - Acc: 0.0624
Epoch 3/10 - Loss: 9.0352 - Acc: 0.2976
Epoch 4/10 - Loss: 4.3835 - Acc: 0.5982
Epoch 5/10 - Loss: 3.7640 - Acc: 0.7046
Epoch 6/10 - Loss: 3.9207 - Acc: 0.7154
Epoch 7/10 - Loss: 3.6135 - Acc: 0.7424
Epoch 8/10 - Loss: 3.7669 - Acc: 0.7334
Epoch 9/10 - Loss: 3.4824 - Acc: 0.7528
Epoch 10/10 - Loss: 3.3764 - Acc: 0.7678
Saved: results_resnet_cifar100/lambda_sweep/lambda_2000/model_task9.pt
Computing Fisher for Task 9...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training Complete!
============================================================
[1/3] Evaluating λ=2000...
/Users/sunilkumars/Desktop/EWC Project/drift_cl_edge/venv/lib/python3.13/site-packages/torchvision/datasets/cifar.py:83: VisibleDeprecationWarning: dtype(): align should be passed as Python or NumPy boolean but got `align=0`. Did you mean to pass a tuple to create a subarray type? (Deprecated NumPy 2.4)
  entry = pickle.load(f, encoding="latin1")
Using device: mps
Split-CIFAR-100 initialized:
  Tasks: 10
  Classes per task: 10
  Class order: [83 53 70 45 44 39 22 80 10  0 18 30 73 33 90  4 76 77 12 31]... (first 20)
Task 0: Classes [83, 53, 70, 45, 44, 39, 22, 80, 10, 0]
  Train samples: 5000
  Test samples: 1000
Task 1: Classes [18, 30, 73, 33, 90, 4, 76, 77, 12, 31]
  Train samples: 5000
  Test samples: 1000
Task 2: Classes [55, 88, 26, 42, 69, 15, 40, 96, 9, 72]
  Train samples: 5000
  Test samples: 1000
Task 3: Classes [11, 47, 85, 28, 93, 5, 66, 65, 35, 16]
  Train samples: 5000
  Test samples: 1000
Task 4: Classes [49, 34, 7, 95, 27, 19, 81, 25, 62, 13]
  Train samples: 5000
  Test samples: 1000
Task 5: Classes [24, 3, 17, 38, 8, 78, 6, 64, 36, 89]
  Train samples: 5000
  Test samples: 1000
Task 6: Classes [56, 99, 54, 43, 50, 67, 46, 68, 61, 97]
  Train samples: 5000
  Test samples: 1000
Task 7: Classes [79, 41, 58, 48, 98, 57, 75, 32, 94, 59]
  Train samples: 5000
  Test samples: 1000
Task 8: Classes [63, 84, 37, 29, 1, 52, 21, 2, 23, 87]
  Train samples: 5000
  Test samples: 1000
Task 9: Classes [91, 74, 86, 82, 20, 60, 71, 14, 92, 51]
  Train samples: 5000
  Test samples: 1000
Task 0: Classes [83, 53, 70, 45, 44, 39, 22, 80, 10, 0]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 0 (Classes: [83, 53, 70, 45, 44, 39, 22, 80, 10, 0])...
Task 0 Accuracy: 0.0000
Task 1: Classes [18, 30, 73, 33, 90, 4, 76, 77, 12, 31]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 1 (Classes: [18, 30, 73, 33, 90, 4, 76, 77, 12, 31])...
Task 1 Accuracy: 0.0000
Task 2: Classes [55, 88, 26, 42, 69, 15, 40, 96, 9, 72]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 2 (Classes: [55, 88, 26, 42, 69, 15, 40, 96, 9, 72])...
Task 2 Accuracy: 0.0000
Task 3: Classes [11, 47, 85, 28, 93, 5, 66, 65, 35, 16]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 3 (Classes: [11, 47, 85, 28, 93, 5, 66, 65, 35, 16])...
Task 3 Accuracy: 0.0000
Task 4: Classes [49, 34, 7, 95, 27, 19, 81, 25, 62, 13]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 4 (Classes: [49, 34, 7, 95, 27, 19, 81, 25, 62, 13])...
Task 4 Accuracy: 0.0000
Task 5: Classes [24, 3, 17, 38, 8, 78, 6, 64, 36, 89]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 5 (Classes: [24, 3, 17, 38, 8, 78, 6, 64, 36, 89])...
Task 5 Accuracy: 0.0000
Task 6: Classes [56, 99, 54, 43, 50, 67, 46, 68, 61, 97]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 6 (Classes: [56, 99, 54, 43, 50, 67, 46, 68, 61, 97])...
Task 6 Accuracy: 0.0000
Task 7: Classes [79, 41, 58, 48, 98, 57, 75, 32, 94, 59]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 7 (Classes: [79, 41, 58, 48, 98, 57, 75, 32, 94, 59])...
Task 7 Accuracy: 0.0000
Task 8: Classes [63, 84, 37, 29, 1, 52, 21, 2, 23, 87]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 8 (Classes: [63, 84, 37, 29, 1, 52, 21, 2, 23, 87])...
Task 8 Accuracy: 0.0010
Task 9: Classes [91, 74, 86, 82, 20, 60, 71, 14, 92, 51]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 9 (Classes: [91, 74, 86, 82, 20, 60, 71, 14, 92, 51])...
Task 9 Accuracy: 0.6990

============================================================
Final Accuracies: ['0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0010', '0.6990']
Average Accuracy: 0.0700
Final Task: 0.6990
Early Tasks Avg: 0.0001
============================================================
Results saved to results_resnet_cifar100/lambda_sweep/lambda_2000_results.json

[2/3] Training λ=5000...
/Users/sunilkumars/Desktop/EWC Project/drift_cl_edge/venv/lib/python3.13/site-packages/torchvision/datasets/cifar.py:83: VisibleDeprecationWarning: dtype(): align should be passed as Python or NumPy boolean but got `align=0`. Did you mean to pass a tuple to create a subarray type? (Deprecated NumPy 2.4)
  entry = pickle.load(f, encoding="latin1")
/Users/sunilkumars/Desktop/EWC Project/drift_cl_edge/venv/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
Using device: mps
Training ResNet-18 on Split-CIFAR-100: 10 tasks, 10 epochs/task, λ=5000.0
Split-CIFAR-100 initialized:
  Tasks: 10
  Classes per task: 10
  Class order: [83 53 70 45 44 39 22 80 10  0 18 30 73 33 90  4 76 77 12 31]... (first 20)
Task 0: Classes [83, 53, 70, 45, 44, 39, 22, 80, 10, 0]
  Train samples: 5000
  Test samples: 1000
Task 1: Classes [18, 30, 73, 33, 90, 4, 76, 77, 12, 31]
  Train samples: 5000
  Test samples: 1000
Task 2: Classes [55, 88, 26, 42, 69, 15, 40, 96, 9, 72]
  Train samples: 5000
  Test samples: 1000
Task 3: Classes [11, 47, 85, 28, 93, 5, 66, 65, 35, 16]
  Train samples: 5000
  Test samples: 1000
Task 4: Classes [49, 34, 7, 95, 27, 19, 81, 25, 62, 13]
  Train samples: 5000
  Test samples: 1000
Task 5: Classes [24, 3, 17, 38, 8, 78, 6, 64, 36, 89]
  Train samples: 5000
  Test samples: 1000
Task 6: Classes [56, 99, 54, 43, 50, 67, 46, 68, 61, 97]
  Train samples: 5000
  Test samples: 1000
Task 7: Classes [79, 41, 58, 48, 98, 57, 75, 32, 94, 59]
  Train samples: 5000
  Test samples: 1000
Task 8: Classes [63, 84, 37, 29, 1, 52, 21, 2, 23, 87]
  Train samples: 5000
  Test samples: 1000
Task 9: Classes [91, 74, 86, 82, 20, 60, 71, 14, 92, 51]
  Train samples: 5000
  Test samples: 1000

============================================================
Training on Task 0 (Classes: [83, 53, 70, 45, 44, 39, 22, 80, 10, 0])
============================================================
Epoch 1/10 - Loss: 1.9106 - Acc: 0.3692
Epoch 2/10 - Loss: 1.4778 - Acc: 0.4740
Epoch 3/10 - Loss: 1.2872 - Acc: 0.5390
Epoch 4/10 - Loss: 1.1885 - Acc: 0.5784
Epoch 5/10 - Loss: 1.0601 - Acc: 0.6312
Epoch 6/10 - Loss: 0.9218 - Acc: 0.6756
Epoch 7/10 - Loss: 0.7512 - Acc: 0.7326
Epoch 8/10 - Loss: 0.6858 - Acc: 0.7596
Epoch 9/10 - Loss: 0.5946 - Acc: 0.7912
Epoch 10/10 - Loss: 0.4070 - Acc: 0.8580
Saved: results_resnet_cifar100/lambda_sweep/lambda_5000/model_task0.pt
Computing Fisher for Task 0...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 1 (Classes: [18, 30, 73, 33, 90, 4, 76, 77, 12, 31])
============================================================
Epoch 1/10 - Loss: 3.7798 - Acc: 0.2990
Epoch 2/10 - Loss: 1.6118 - Acc: 0.5704
Epoch 3/10 - Loss: 1.5174 - Acc: 0.6508
Epoch 4/10 - Loss: 1.4572 - Acc: 0.7064
Epoch 5/10 - Loss: 1.6355 - Acc: 0.7136
Epoch 6/10 - Loss: 1.4271 - Acc: 0.7660
Epoch 7/10 - Loss: 1.4057 - Acc: 0.7980
Epoch 8/10 - Loss: 1.3633 - Acc: 0.8184
Epoch 9/10 - Loss: 1.2137 - Acc: 0.8618
Epoch 10/10 - Loss: 1.2375 - Acc: 0.8714
Saved: results_resnet_cifar100/lambda_sweep/lambda_5000/model_task1.pt
Computing Fisher for Task 1...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 2 (Classes: [55, 88, 26, 42, 69, 15, 40, 96, 9, 72])
============================================================
Epoch 1/10 - Loss: 7.1529 - Acc: 0.3184
Epoch 2/10 - Loss: 2.7227 - Acc: 0.5490
Epoch 3/10 - Loss: 2.5911 - Acc: 0.5922
Epoch 4/10 - Loss: 2.7069 - Acc: 0.6088
Epoch 5/10 - Loss: 2.7692 - Acc: 0.6270
Epoch 6/10 - Loss: 2.7640 - Acc: 0.6560
Epoch 7/10 - Loss: 2.5907 - Acc: 0.7040
Epoch 8/10 - Loss: 2.5289 - Acc: 0.7316
Epoch 9/10 - Loss: 2.6721 - Acc: 0.7378
Epoch 10/10 - Loss: 2.4282 - Acc: 0.7810
Saved: results_resnet_cifar100/lambda_sweep/lambda_5000/model_task2.pt
Computing Fisher for Task 2...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 3 (Classes: [11, 47, 85, 28, 93, 5, 66, 65, 35, 16])
============================================================
Epoch 1/10 - Loss: 12.7064 - Acc: 0.2670
Epoch 2/10 - Loss: 3.3848 - Acc: 0.5648
Epoch 3/10 - Loss: 3.2685 - Acc: 0.6118
Epoch 4/10 - Loss: 3.2347 - Acc: 0.6366
Epoch 5/10 - Loss: 3.3120 - Acc: 0.6530
Epoch 6/10 - Loss: 3.2754 - Acc: 0.6670
Epoch 7/10 - Loss: 3.4235 - Acc: 0.6786
Epoch 8/10 - Loss: 3.2642 - Acc: 0.7050
Epoch 9/10 - Loss: 3.3489 - Acc: 0.7062
Epoch 10/10 - Loss: 3.2339 - Acc: 0.7298
Saved: results_resnet_cifar100/lambda_sweep/lambda_5000/model_task3.pt
Computing Fisher for Task 3...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 4 (Classes: [49, 34, 7, 95, 27, 19, 81, 25, 62, 13])
============================================================
Epoch 1/10 - Loss: 18.2533 - Acc: 0.0804
Epoch 2/10 - Loss: 3.7331 - Acc: 0.5578
Epoch 3/10 - Loss: 3.4600 - Acc: 0.6434
Epoch 4/10 - Loss: 3.3413 - Acc: 0.6608
Epoch 5/10 - Loss: 3.7155 - Acc: 0.6634
Epoch 6/10 - Loss: 3.4330 - Acc: 0.6882
Epoch 7/10 - Loss: 3.2817 - Acc: 0.6944
Epoch 8/10 - Loss: 3.3484 - Acc: 0.7064
Epoch 9/10 - Loss: 3.2660 - Acc: 0.7134
Epoch 10/10 - Loss: 3.4532 - Acc: 0.7082
Saved: results_resnet_cifar100/lambda_sweep/lambda_5000/model_task4.pt
Computing Fisher for Task 4...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 5 (Classes: [24, 3, 17, 38, 8, 78, 6, 64, 36, 89])
============================================================
Epoch 1/10 - Loss: 22.1086 - Acc: 0.1260
Epoch 2/10 - Loss: 4.0289 - Acc: 0.5638
Epoch 3/10 - Loss: 3.6957 - Acc: 0.6020
Epoch 4/10 - Loss: 3.7448 - Acc: 0.6220
Epoch 5/10 - Loss: 3.7559 - Acc: 0.6270
Epoch 6/10 - Loss: 3.8400 - Acc: 0.6352
Epoch 7/10 - Loss: 3.7810 - Acc: 0.6398
Epoch 8/10 - Loss: 3.8817 - Acc: 0.6628
Epoch 9/10 - Loss: 3.9053 - Acc: 0.6594
Epoch 10/10 - Loss: 3.7113 - Acc: 0.6688
Saved: results_resnet_cifar100/lambda_sweep/lambda_5000/model_task5.pt
Computing Fisher for Task 5...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 6 (Classes: [56, 99, 54, 43, 50, 67, 46, 68, 61, 97])
============================================================
Epoch 1/10 - Loss: 26.9377 - Acc: 0.0156
Epoch 2/10 - Loss: 6.2431 - Acc: 0.2968
Epoch 3/10 - Loss: 3.9135 - Acc: 0.6178
Epoch 4/10 - Loss: 3.8380 - Acc: 0.6400
Epoch 5/10 - Loss: 3.7528 - Acc: 0.6660
Epoch 6/10 - Loss: 3.8813 - Acc: 0.6454
Epoch 7/10 - Loss: 3.8599 - Acc: 0.6602
Epoch 8/10 - Loss: 3.7431 - Acc: 0.6780
Epoch 9/10 - Loss: 3.7480 - Acc: 0.6798
Epoch 10/10 - Loss: 4.0731 - Acc: 0.6766
Saved: results_resnet_cifar100/lambda_sweep/lambda_5000/model_task6.pt
Computing Fisher for Task 6...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 7 (Classes: [79, 41, 58, 48, 98, 57, 75, 32, 94, 59])
============================================================
Epoch 1/10 - Loss: 34.1563 - Acc: 0.0148
Epoch 2/10 - Loss: 7.2901 - Acc: 0.2976
Epoch 3/10 - Loss: 4.0564 - Acc: 0.6496
Epoch 4/10 - Loss: 3.8685 - Acc: 0.6826
Epoch 5/10 - Loss: 3.7409 - Acc: 0.7014
Epoch 6/10 - Loss: 3.8735 - Acc: 0.7090
Epoch 7/10 - Loss: 3.9560 - Acc: 0.7084
Epoch 8/10 - Loss: 4.0412 - Acc: 0.7136
Epoch 9/10 - Loss: 3.8399 - Acc: 0.7262
Epoch 10/10 - Loss: 3.7090 - Acc: 0.7342
Saved: results_resnet_cifar100/lambda_sweep/lambda_5000/model_task7.pt
Computing Fisher for Task 7...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 8 (Classes: [63, 84, 37, 29, 1, 52, 21, 2, 23, 87])
============================================================
Epoch 1/10 - Loss: 35.8402 - Acc: 0.0058
Epoch 2/10 - Loss: 8.9636 - Acc: 0.1904
Epoch 3/10 - Loss: 4.4827 - Acc: 0.6152
Epoch 4/10 - Loss: 3.9681 - Acc: 0.6778
Epoch 5/10 - Loss: 3.8825 - Acc: 0.6834
Epoch 6/10 - Loss: 3.9515 - Acc: 0.6940
Epoch 7/10 - Loss: 4.0000 - Acc: 0.7014
Epoch 8/10 - Loss: 4.1034 - Acc: 0.6966
Epoch 9/10 - Loss: 3.8911 - Acc: 0.7156
Epoch 10/10 - Loss: 4.0770 - Acc: 0.7034
Saved: results_resnet_cifar100/lambda_sweep/lambda_5000/model_task8.pt
Computing Fisher for Task 8...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 9 (Classes: [91, 74, 86, 82, 20, 60, 71, 14, 92, 51])
============================================================
Epoch 1/10 - Loss: 38.2623 - Acc: 0.0010
Epoch 2/10 - Loss: 11.1455 - Acc: 0.1846
Epoch 3/10 - Loss: 4.8032 - Acc: 0.5582
Epoch 4/10 - Loss: 4.1891 - Acc: 0.6622
Epoch 5/10 - Loss: 3.9950 - Acc: 0.6726
Epoch 6/10 - Loss: 4.0492 - Acc: 0.6740
Epoch 7/10 - Loss: 3.9903 - Acc: 0.6756
Epoch 8/10 - Loss: 3.7922 - Acc: 0.6998
Epoch 9/10 - Loss: 3.8142 - Acc: 0.6964
Epoch 10/10 - Loss: 3.8437 - Acc: 0.7098
Saved: results_resnet_cifar100/lambda_sweep/lambda_5000/model_task9.pt
Computing Fisher for Task 9...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training Complete!
============================================================
[2/3] Evaluating λ=5000...
/Users/sunilkumars/Desktop/EWC Project/drift_cl_edge/venv/lib/python3.13/site-packages/torchvision/datasets/cifar.py:83: VisibleDeprecationWarning: dtype(): align should be passed as Python or NumPy boolean but got `align=0`. Did you mean to pass a tuple to create a subarray type? (Deprecated NumPy 2.4)
  entry = pickle.load(f, encoding="latin1")
Using device: mps
Split-CIFAR-100 initialized:
  Tasks: 10
  Classes per task: 10
  Class order: [83 53 70 45 44 39 22 80 10  0 18 30 73 33 90  4 76 77 12 31]... (first 20)
Task 0: Classes [83, 53, 70, 45, 44, 39, 22, 80, 10, 0]
  Train samples: 5000
  Test samples: 1000
Task 1: Classes [18, 30, 73, 33, 90, 4, 76, 77, 12, 31]
  Train samples: 5000
  Test samples: 1000
Task 2: Classes [55, 88, 26, 42, 69, 15, 40, 96, 9, 72]
  Train samples: 5000
  Test samples: 1000
Task 3: Classes [11, 47, 85, 28, 93, 5, 66, 65, 35, 16]
  Train samples: 5000
  Test samples: 1000
Task 4: Classes [49, 34, 7, 95, 27, 19, 81, 25, 62, 13]
  Train samples: 5000
  Test samples: 1000
Task 5: Classes [24, 3, 17, 38, 8, 78, 6, 64, 36, 89]
  Train samples: 5000
  Test samples: 1000
Task 6: Classes [56, 99, 54, 43, 50, 67, 46, 68, 61, 97]
  Train samples: 5000
  Test samples: 1000
Task 7: Classes [79, 41, 58, 48, 98, 57, 75, 32, 94, 59]
  Train samples: 5000
  Test samples: 1000
Task 8: Classes [63, 84, 37, 29, 1, 52, 21, 2, 23, 87]
  Train samples: 5000
  Test samples: 1000
Task 9: Classes [91, 74, 86, 82, 20, 60, 71, 14, 92, 51]
  Train samples: 5000
  Test samples: 1000
Task 0: Classes [83, 53, 70, 45, 44, 39, 22, 80, 10, 0]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 0 (Classes: [83, 53, 70, 45, 44, 39, 22, 80, 10, 0])...
Task 0 Accuracy: 0.0000
Task 1: Classes [18, 30, 73, 33, 90, 4, 76, 77, 12, 31]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 1 (Classes: [18, 30, 73, 33, 90, 4, 76, 77, 12, 31])...
Task 1 Accuracy: 0.0000
Task 2: Classes [55, 88, 26, 42, 69, 15, 40, 96, 9, 72]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 2 (Classes: [55, 88, 26, 42, 69, 15, 40, 96, 9, 72])...
Task 2 Accuracy: 0.0000
Task 3: Classes [11, 47, 85, 28, 93, 5, 66, 65, 35, 16]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 3 (Classes: [11, 47, 85, 28, 93, 5, 66, 65, 35, 16])...
Task 3 Accuracy: 0.0000
Task 4: Classes [49, 34, 7, 95, 27, 19, 81, 25, 62, 13]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 4 (Classes: [49, 34, 7, 95, 27, 19, 81, 25, 62, 13])...
Task 4 Accuracy: 0.0000
Task 5: Classes [24, 3, 17, 38, 8, 78, 6, 64, 36, 89]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 5 (Classes: [24, 3, 17, 38, 8, 78, 6, 64, 36, 89])...
Task 5 Accuracy: 0.0000
Task 6: Classes [56, 99, 54, 43, 50, 67, 46, 68, 61, 97]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 6 (Classes: [56, 99, 54, 43, 50, 67, 46, 68, 61, 97])...
Task 6 Accuracy: 0.0000
Task 7: Classes [79, 41, 58, 48, 98, 57, 75, 32, 94, 59]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 7 (Classes: [79, 41, 58, 48, 98, 57, 75, 32, 94, 59])...
Task 7 Accuracy: 0.0000
Task 8: Classes [63, 84, 37, 29, 1, 52, 21, 2, 23, 87]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 8 (Classes: [63, 84, 37, 29, 1, 52, 21, 2, 23, 87])...
Task 8 Accuracy: 0.0000
Task 9: Classes [91, 74, 86, 82, 20, 60, 71, 14, 92, 51]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 9 (Classes: [91, 74, 86, 82, 20, 60, 71, 14, 92, 51])...
Task 9 Accuracy: 0.6270

============================================================
Final Accuracies: ['0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.6270']
Average Accuracy: 0.0627
Final Task: 0.6270
Early Tasks Avg: 0.0000
============================================================
Results saved to results_resnet_cifar100/lambda_sweep/lambda_5000_results.json

[3/3] Training Annealed EWC (λ₀=5000)...
/Users/sunilkumars/Desktop/EWC Project/drift_cl_edge/venv/lib/python3.13/site-packages/torchvision/datasets/cifar.py:83: VisibleDeprecationWarning: dtype(): align should be passed as Python or NumPy boolean but got `align=0`. Did you mean to pass a tuple to create a subarray type? (Deprecated NumPy 2.4)
  entry = pickle.load(f, encoding="latin1")
/Users/sunilkumars/Desktop/EWC Project/drift_cl_edge/venv/lib/python3.13/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
  warnings.warn(warn_msg)
Using device: mps
Training ResNet-18 on Split-CIFAR-100 with Annealed EWC
λ schedule: λ_t = 5000.0/(1+t)
Split-CIFAR-100 initialized:
  Tasks: 10
  Classes per task: 10
  Class order: [83 53 70 45 44 39 22 80 10  0 18 30 73 33 90  4 76 77 12 31]... (first 20)
Task 0: Classes [83, 53, 70, 45, 44, 39, 22, 80, 10, 0]
  Train samples: 5000
  Test samples: 1000
Task 1: Classes [18, 30, 73, 33, 90, 4, 76, 77, 12, 31]
  Train samples: 5000
  Test samples: 1000
Task 2: Classes [55, 88, 26, 42, 69, 15, 40, 96, 9, 72]
  Train samples: 5000
  Test samples: 1000
Task 3: Classes [11, 47, 85, 28, 93, 5, 66, 65, 35, 16]
  Train samples: 5000
  Test samples: 1000
Task 4: Classes [49, 34, 7, 95, 27, 19, 81, 25, 62, 13]
  Train samples: 5000
  Test samples: 1000
Task 5: Classes [24, 3, 17, 38, 8, 78, 6, 64, 36, 89]
  Train samples: 5000
  Test samples: 1000
Task 6: Classes [56, 99, 54, 43, 50, 67, 46, 68, 61, 97]
  Train samples: 5000
  Test samples: 1000
Task 7: Classes [79, 41, 58, 48, 98, 57, 75, 32, 94, 59]
  Train samples: 5000
  Test samples: 1000
Task 8: Classes [63, 84, 37, 29, 1, 52, 21, 2, 23, 87]
  Train samples: 5000
  Test samples: 1000
Task 9: Classes [91, 74, 86, 82, 20, 60, 71, 14, 92, 51]
  Train samples: 5000
  Test samples: 1000

============================================================
Training on Task 0 (Classes: [83, 53, 70, 45, 44, 39, 22, 80, 10, 0], λ=5000.0)
============================================================
Epoch 1/10 - Loss: 1.9264 - Acc: 0.3566
Epoch 2/10 - Loss: 1.4800 - Acc: 0.4694
Epoch 3/10 - Loss: 1.2927 - Acc: 0.5376
Epoch 4/10 - Loss: 1.2078 - Acc: 0.5818
Epoch 5/10 - Loss: 1.0344 - Acc: 0.6336
Epoch 6/10 - Loss: 0.9541 - Acc: 0.6596
Epoch 7/10 - Loss: 0.7893 - Acc: 0.7154
Epoch 8/10 - Loss: 0.7479 - Acc: 0.7384
Epoch 9/10 - Loss: 0.6411 - Acc: 0.7780
Epoch 10/10 - Loss: 0.4813 - Acc: 0.8318
Saved: checkpoints_resnet_cifar100_annealed/model_task0.pt
Computing Fisher for Task 0 (λ=5000.0)...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 1 (Classes: [18, 30, 73, 33, 90, 4, 76, 77, 12, 31], λ=2500.0)
============================================================
Epoch 1/10 - Loss: 3.7346 - Acc: 0.3156
Epoch 2/10 - Loss: 1.5631 - Acc: 0.5584
Epoch 3/10 - Loss: 1.3440 - Acc: 0.6562
Epoch 4/10 - Loss: 1.4600 - Acc: 0.6726
Epoch 5/10 - Loss: 1.1415 - Acc: 0.7512
Epoch 6/10 - Loss: 1.1208 - Acc: 0.7764
Epoch 7/10 - Loss: 1.2700 - Acc: 0.7788
Epoch 8/10 - Loss: 0.9699 - Acc: 0.8630
Epoch 9/10 - Loss: 1.3580 - Acc: 0.7976
Epoch 10/10 - Loss: 0.7961 - Acc: 0.9344
Saved: checkpoints_resnet_cifar100_annealed/model_task1.pt
Computing Fisher for Task 1 (λ=2500.0)...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 2 (Classes: [55, 88, 26, 42, 69, 15, 40, 96, 9, 72], λ=1666.7)
============================================================
Epoch 1/10 - Loss: 7.5300 - Acc: 0.2372
Epoch 2/10 - Loss: 2.3912 - Acc: 0.5086
Epoch 3/10 - Loss: 2.1284 - Acc: 0.6032
Epoch 4/10 - Loss: 1.9997 - Acc: 0.6616
Epoch 5/10 - Loss: 1.9796 - Acc: 0.6966
Epoch 6/10 - Loss: 2.1483 - Acc: 0.7194
Epoch 7/10 - Loss: 2.0585 - Acc: 0.7556
Epoch 8/10 - Loss: 1.9777 - Acc: 0.7888
Epoch 9/10 - Loss: 2.1501 - Acc: 0.7982
Epoch 10/10 - Loss: 2.4380 - Acc: 0.7880
Saved: checkpoints_resnet_cifar100_annealed/model_task2.pt
Computing Fisher for Task 2 (λ=1666.7)...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 3 (Classes: [11, 47, 85, 28, 93, 5, 66, 65, 35, 16], λ=1250.0)
============================================================
Epoch 1/10 - Loss: 11.2174 - Acc: 0.1360
Epoch 2/10 - Loss: 2.9555 - Acc: 0.5444
Epoch 3/10 - Loss: 2.6348 - Acc: 0.6544
Epoch 4/10 - Loss: 2.6156 - Acc: 0.6882
Epoch 5/10 - Loss: 2.7315 - Acc: 0.7182
Epoch 6/10 - Loss: 2.7370 - Acc: 0.7410
Epoch 7/10 - Loss: 2.7853 - Acc: 0.7668
Epoch 8/10 - Loss: 2.9324 - Acc: 0.7658
Epoch 9/10 - Loss: 2.8206 - Acc: 0.8100
Epoch 10/10 - Loss: 2.3719 - Acc: 0.8542
Saved: checkpoints_resnet_cifar100_annealed/model_task3.pt
Computing Fisher for Task 3 (λ=1250.0)...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 4 (Classes: [49, 34, 7, 95, 27, 19, 81, 25, 62, 13], λ=1000.0)
============================================================
Epoch 1/10 - Loss: 15.3226 - Acc: 0.0932
Epoch 2/10 - Loss: 3.6022 - Acc: 0.5762
Epoch 3/10 - Loss: 3.1746 - Acc: 0.6708
Epoch 4/10 - Loss: 3.1547 - Acc: 0.7010
Epoch 5/10 - Loss: 3.1415 - Acc: 0.7070
Epoch 6/10 - Loss: 2.9663 - Acc: 0.7392
Epoch 7/10 - Loss: 3.0654 - Acc: 0.7446
Epoch 8/10 - Loss: 3.2633 - Acc: 0.7500
Epoch 9/10 - Loss: 3.1319 - Acc: 0.7590
Epoch 10/10 - Loss: 2.9101 - Acc: 0.7980
Saved: checkpoints_resnet_cifar100_annealed/model_task4.pt
Computing Fisher for Task 4 (λ=1000.0)...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 5 (Classes: [24, 3, 17, 38, 8, 78, 6, 64, 36, 89], λ=833.3)
============================================================
Epoch 1/10 - Loss: 20.5439 - Acc: 0.0422
Epoch 2/10 - Loss: 4.1965 - Acc: 0.5108
Epoch 3/10 - Loss: 3.7096 - Acc: 0.6398
Epoch 4/10 - Loss: 3.7617 - Acc: 0.6422
Epoch 5/10 - Loss: 3.5794 - Acc: 0.6774
Epoch 6/10 - Loss: 3.7905 - Acc: 0.6728
Epoch 7/10 - Loss: 3.9042 - Acc: 0.6806
Epoch 8/10 - Loss: 3.7639 - Acc: 0.6892
Epoch 9/10 - Loss: 3.7486 - Acc: 0.6862
Epoch 10/10 - Loss: 3.6772 - Acc: 0.7006
Saved: checkpoints_resnet_cifar100_annealed/model_task5.pt
Computing Fisher for Task 5 (λ=833.3)...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 6 (Classes: [56, 99, 54, 43, 50, 67, 46, 68, 61, 97], λ=714.3)
============================================================
Epoch 1/10 - Loss: 23.1616 - Acc: 0.0190
Epoch 2/10 - Loss: 5.7000 - Acc: 0.3210
Epoch 3/10 - Loss: 3.6953 - Acc: 0.6506
Epoch 4/10 - Loss: 3.4924 - Acc: 0.6938
Epoch 5/10 - Loss: 3.6530 - Acc: 0.6978
Epoch 6/10 - Loss: 3.8386 - Acc: 0.6972
Epoch 7/10 - Loss: 3.5101 - Acc: 0.7200
Epoch 8/10 - Loss: 3.5302 - Acc: 0.7282
Epoch 9/10 - Loss: 3.7425 - Acc: 0.7182
Epoch 10/10 - Loss: 3.7029 - Acc: 0.7272
Saved: checkpoints_resnet_cifar100_annealed/model_task6.pt
Computing Fisher for Task 6 (λ=714.3)...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 7 (Classes: [79, 41, 58, 48, 98, 57, 75, 32, 94, 59], λ=625.0)
============================================================
Epoch 1/10 - Loss: 26.4402 - Acc: 0.0066
Epoch 2/10 - Loss: 5.7521 - Acc: 0.3524
Epoch 3/10 - Loss: 3.9302 - Acc: 0.6872
Epoch 4/10 - Loss: 3.6583 - Acc: 0.7200
Epoch 5/10 - Loss: 3.8029 - Acc: 0.7348
Epoch 6/10 - Loss: 3.4440 - Acc: 0.7416
Epoch 7/10 - Loss: 3.5180 - Acc: 0.7564
Epoch 8/10 - Loss: 3.8261 - Acc: 0.7362
Epoch 9/10 - Loss: 3.5131 - Acc: 0.7596
Epoch 10/10 - Loss: 3.4732 - Acc: 0.7726
Saved: checkpoints_resnet_cifar100_annealed/model_task7.pt
Computing Fisher for Task 7 (λ=625.0)...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 8 (Classes: [63, 84, 37, 29, 1, 52, 21, 2, 23, 87], λ=555.6)
============================================================
Epoch 1/10 - Loss: 30.1074 - Acc: 0.0064
Epoch 2/10 - Loss: 8.2300 - Acc: 0.1762
Epoch 3/10 - Loss: 4.0715 - Acc: 0.6188
Epoch 4/10 - Loss: 3.6550 - Acc: 0.7130
Epoch 5/10 - Loss: 3.8157 - Acc: 0.7174
Epoch 6/10 - Loss: 3.6708 - Acc: 0.7140
Epoch 7/10 - Loss: 3.7747 - Acc: 0.7220
Epoch 8/10 - Loss: 3.7166 - Acc: 0.7352
Epoch 9/10 - Loss: 3.5738 - Acc: 0.7496
Epoch 10/10 - Loss: 3.5132 - Acc: 0.7528
Saved: checkpoints_resnet_cifar100_annealed/model_task8.pt
Computing Fisher for Task 8 (λ=555.6)...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Training on Task 9 (Classes: [91, 74, 86, 82, 20, 60, 71, 14, 92, 51], λ=500.0)
============================================================
Epoch 1/10 - Loss: 30.3980 - Acc: 0.0024
Epoch 2/10 - Loss: 20.3043 - Acc: 0.1714
Epoch 3/10 - Loss: 5.0704 - Acc: 0.5174
Epoch 4/10 - Loss: 3.9386 - Acc: 0.6882
Epoch 5/10 - Loss: 3.5515 - Acc: 0.7246
Epoch 6/10 - Loss: 3.6592 - Acc: 0.7280
Epoch 7/10 - Loss: 3.6354 - Acc: 0.7266
Epoch 8/10 - Loss: 3.5012 - Acc: 0.7352
Epoch 9/10 - Loss: 3.5598 - Acc: 0.7426
Epoch 10/10 - Loss: 3.5729 - Acc: 0.7430
Saved: checkpoints_resnet_cifar100_annealed/model_task9.pt
Computing Fisher for Task 9 (λ=500.0)...
Computing Fisher Matrix...
Fisher Matrix computed.

============================================================
Annealed EWC Training Complete!
λ schedule used: ['5000.0', '2500.0', '1666.7', '1250.0', '1000.0', '833.3', '714.3', '625.0', '555.6', '500.0']
============================================================
[3/3] Evaluating Annealed EWC...
/Users/sunilkumars/Desktop/EWC Project/drift_cl_edge/venv/lib/python3.13/site-packages/torchvision/datasets/cifar.py:83: VisibleDeprecationWarning: dtype(): align should be passed as Python or NumPy boolean but got `align=0`. Did you mean to pass a tuple to create a subarray type? (Deprecated NumPy 2.4)
  entry = pickle.load(f, encoding="latin1")
Using device: mps
Split-CIFAR-100 initialized:
  Tasks: 10
  Classes per task: 10
  Class order: [83 53 70 45 44 39 22 80 10  0 18 30 73 33 90  4 76 77 12 31]... (first 20)
Task 0: Classes [83, 53, 70, 45, 44, 39, 22, 80, 10, 0]
  Train samples: 5000
  Test samples: 1000
Task 1: Classes [18, 30, 73, 33, 90, 4, 76, 77, 12, 31]
  Train samples: 5000
  Test samples: 1000
Task 2: Classes [55, 88, 26, 42, 69, 15, 40, 96, 9, 72]
  Train samples: 5000
  Test samples: 1000
Task 3: Classes [11, 47, 85, 28, 93, 5, 66, 65, 35, 16]
  Train samples: 5000
  Test samples: 1000
Task 4: Classes [49, 34, 7, 95, 27, 19, 81, 25, 62, 13]
  Train samples: 5000
  Test samples: 1000
Task 5: Classes [24, 3, 17, 38, 8, 78, 6, 64, 36, 89]
  Train samples: 5000
  Test samples: 1000
Task 6: Classes [56, 99, 54, 43, 50, 67, 46, 68, 61, 97]
  Train samples: 5000
  Test samples: 1000
Task 7: Classes [79, 41, 58, 48, 98, 57, 75, 32, 94, 59]
  Train samples: 5000
  Test samples: 1000
Task 8: Classes [63, 84, 37, 29, 1, 52, 21, 2, 23, 87]
  Train samples: 5000
  Test samples: 1000
Task 9: Classes [91, 74, 86, 82, 20, 60, 71, 14, 92, 51]
  Train samples: 5000
  Test samples: 1000
Task 0: Classes [83, 53, 70, 45, 44, 39, 22, 80, 10, 0]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 0 (Classes: [83, 53, 70, 45, 44, 39, 22, 80, 10, 0])...
Task 0 Accuracy: 0.0000
Task 1: Classes [18, 30, 73, 33, 90, 4, 76, 77, 12, 31]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 1 (Classes: [18, 30, 73, 33, 90, 4, 76, 77, 12, 31])...
Task 1 Accuracy: 0.0000
Task 2: Classes [55, 88, 26, 42, 69, 15, 40, 96, 9, 72]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 2 (Classes: [55, 88, 26, 42, 69, 15, 40, 96, 9, 72])...
Task 2 Accuracy: 0.0000
Task 3: Classes [11, 47, 85, 28, 93, 5, 66, 65, 35, 16]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 3 (Classes: [11, 47, 85, 28, 93, 5, 66, 65, 35, 16])...
Task 3 Accuracy: 0.0000
Task 4: Classes [49, 34, 7, 95, 27, 19, 81, 25, 62, 13]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 4 (Classes: [49, 34, 7, 95, 27, 19, 81, 25, 62, 13])...
Task 4 Accuracy: 0.0000
Task 5: Classes [24, 3, 17, 38, 8, 78, 6, 64, 36, 89]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 5 (Classes: [24, 3, 17, 38, 8, 78, 6, 64, 36, 89])...
Task 5 Accuracy: 0.0000
Task 6: Classes [56, 99, 54, 43, 50, 67, 46, 68, 61, 97]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 6 (Classes: [56, 99, 54, 43, 50, 67, 46, 68, 61, 97])...
Task 6 Accuracy: 0.0000
Task 7: Classes [79, 41, 58, 48, 98, 57, 75, 32, 94, 59]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 7 (Classes: [79, 41, 58, 48, 98, 57, 75, 32, 94, 59])...
Task 7 Accuracy: 0.0000
Task 8: Classes [63, 84, 37, 29, 1, 52, 21, 2, 23, 87]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 8 (Classes: [63, 84, 37, 29, 1, 52, 21, 2, 23, 87])...
Task 8 Accuracy: 0.0000
Task 9: Classes [91, 74, 86, 82, 20, 60, 71, 14, 92, 51]
  Train samples: 5000
  Test samples: 1000
Evaluating on Task 9 (Classes: [91, 74, 86, 82, 20, 60, 71, 14, 92, 51])...
Task 9 Accuracy: 0.6380

============================================================
Final Accuracies: ['0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.6380']
Average Accuracy: 0.0638
Final Task: 0.6380
Early Tasks Avg: 0.0000
============================================================
Results saved to results_resnet_cifar100/annealed_ewc/annealed_results.json

==========================================
✓ ALL ResNet-18 CIFAR-100 EXPERIMENTS COMPLETE!
End time: Sat Jan 31 00:58:22 IST 2026
==========================================

Results saved to: results_resnet_cifar100/

